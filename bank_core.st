Object subclass: #Banco	instanceVariableNames: 'cuentas'	classVariableNames: ''	package: 'TpBancos'!!Banco methodsFor: 'initialization' stamp: 'Anonymous 9/15/2025 17:34'!initialize 	super initialize.	cuentas := OrderedCollection new.! !!Banco methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 17:33'!clientesConSaldoNegativo|cuentasNegativas dnis|            cuentasNegativas:= cuentas select: [ :x | x saldo < 0 ].        dnis := (cuentasNegativas collect: [ :x | x dniTitular ]) asSet.			^ dnis! !!Banco methodsFor: 'propios' stamp: 'Anonymous 9/15/2025 17:44'!agregarCuenta:unaCuenta    (unaCuenta isKindOf: Cuenta) ifFalse: [ self error: 'No es una cuenta válida' ].    unaCuenta numeroCuenta isNil ifTrue: [ self error: 'Falta numeroCuenta' ].    (cuentas detect: [:x | x numeroCuenta = unaCuenta numeroCuenta ] ifNone: [ nil ])        ifNotNil: [ self error: 'Ya existe una cuenta con ese número' ].    cuentas add: unaCuenta.    ^ unaCuenta! !!Banco methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 17:30'!mayorSaldo    | dnis dniMax saldoMax dniMayorSaldo  |    cuentas isEmpty ifTrue: [ ^ 'No hay una cuenta cargada' ].    dnis := (cuentas collect: [ :x | x dniTitular ]) asSet.    dniMax := nil.    saldoMax := nil.    dnis do: [ :dni |        | saldo |        saldo := self saldoTotalCliente: dni.        (dniMax isNil or: [ saldo > saldoMax ]) ifTrue: [            dniMax := dni.            saldoMax := saldo ] ].    dniMayorSaldo := dniMax.    ^ dniMax! !!Banco methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 19:24'!saldoTotalCliente:unDni |s cuentasCliente|s := 0.	cuentasCliente:= cuentas select: [ :x | x  dniTitular asString = unDni asString ].	cuentasCliente do: [ :x | s:=s + x  saldo ].	^ s! !Object subclass: #Cuenta	instanceVariableNames: 'numeroCuenta dniTitular saldo'	classVariableNames: ''	package: 'TpBancos'!!Cuenta methodsFor: 'modifying' stamp: 'Anonymous 9/10/2025 18:54'!saldo: anObject	saldo := anObject! !!Cuenta methodsFor: 'modifying' stamp: 'Anonymous 9/10/2025 18:54'!numeroCuenta: anObject	numeroCuenta := anObject! !!Cuenta methodsFor: 'modifying' stamp: 'Anonymous 9/10/2025 18:54'!dniTitular: anObject	dniTitular := anObject! !!Cuenta methodsFor: 'asString' stamp: 'Anonymous 9/11/2025 17:56'!asString ^ 'Numero de cuenta: ', numeroCuenta asString, ' Numero de DNI: ', dniTitular asString, ' Saldo: ', saldo asString! !!Cuenta methodsFor: 'accessing' stamp: 'Anonymous 9/10/2025 18:54'!saldo	^ saldo! !!Cuenta methodsFor: 'accessing' stamp: 'Anonymous 9/10/2025 18:54'!numeroCuenta	^ numeroCuenta! !!Cuenta methodsFor: 'accessing' stamp: 'Anonymous 9/10/2025 18:54'!dniTitular	^ dniTitular! !!Cuenta methodsFor: 'initialization' stamp: 'Anonymous 9/15/2025 17:34'!initialize saldo := 0.numeroCuenta := 0.dniTitular := 0.! !!Cuenta methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 17:21'!depositarMonto:unMonto			saldo := saldo + unMonto	! !!Cuenta methodsFor: 'propios' stamp: 'Anonymous 9/15/2025 17:37'!extraerMonto:unMonto	"Cada subclase decude la politica de extraccion"	self subclassResponsibility 	! !Cuenta subclass: #CajaDeAhorro	instanceVariableNames: ''	classVariableNames: ''	package: 'TpBancos'!!CajaDeAhorro methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:25'!saldo:unSaldosuper saldo:unSaldo! !!CajaDeAhorro methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:24'!numeroCuenta:unNumerosuper numeroCuenta:unNumero! !!CajaDeAhorro methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:24'!dniTitular:unDnisuper dniTitular:unDni! !!CajaDeAhorro methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 16:12'!depositarMonto:unMonto		"Suma el monto al saldo"	saldo := saldo + unMonto! !!CajaDeAhorro methodsFor: 'propios' stamp: 'Anonymous 9/15/2025 18:18'!extraerMonto:unMonto		(saldo >= unMonto)		ifTrue: [ saldo := saldo - unMonto. ^ 'Saldo restante: ', saldo asString ]		ifFalse: [ ^ 'Saldo insuficiente' ].! !!CajaDeAhorro methodsFor: 'accesing' stamp: 'Anonymous 9/11/2025 16:22'!saldo ^ super saldo ! !!CajaDeAhorro methodsFor: 'accesing' stamp: 'Anonymous 9/11/2025 16:22'!numeroCuenta ^ super numeroCuenta! !!CajaDeAhorro methodsFor: 'accesing' stamp: 'Anonymous 9/11/2025 16:22'!dniTitular ^ super dniTitular ! !!CajaDeAhorro methodsFor: 'asString' stamp: 'Anonymous 9/11/2025 18:08'!asString^ super asString ! !!CajaDeAhorro methodsFor: 'initialization' stamp: 'Anonymous 9/11/2025 17:50'!initializesuper initialize! !Cuenta subclass: #CuentaCorriente	instanceVariableNames: 'limiteDescubierto'	classVariableNames: ''	package: 'TpBancos'!!CuentaCorriente methodsFor: 'accessing' stamp: 'Anonymous 9/11/2025 19:13'!saldo^ super saldo! !!CuentaCorriente methodsFor: 'accessing' stamp: 'Anonymous 9/10/2025 19:09'!limiteDescubierto	^ limiteDescubierto! !!CuentaCorriente methodsFor: 'accessing' stamp: 'Anonymous 9/11/2025 16:27'!numeroCuenta ^ super numeroCuenta ! !!CuentaCorriente methodsFor: 'accessing' stamp: 'Anonymous 9/11/2025 16:27'!dniTitular ^ super dniTitular ! !!CuentaCorriente methodsFor: 'initialization' stamp: 'Anonymous 9/11/2025 17:51'!initializesuper initialize.	limiteDescubierto := 0! !!CuentaCorriente methodsFor: 'propios' stamp: 'Anonymous 9/11/2025 16:12'!depositarMonto:unMonto		"Suma el monto al saldo"	saldo := saldo + unMonto				! !!CuentaCorriente methodsFor: 'propios' stamp: 'Anonymous 9/15/2025 18:12'!extraerMonto:unMonto	"Extrae permitiendo saldo negativo hasta el limite de descubierto"	((saldo - unMonto) >= (0 - limiteDescubierto ))		ifTrue: [ saldo := saldo - unMonto.  ]		ifFalse: [ ^ 'Supera el limite de descubierto' ]				! !!CuentaCorriente methodsFor: 'modifying' stamp: 'Anonymous 9/10/2025 19:09'!limiteDescubierto: anObject	limiteDescubierto := anObject! !!CuentaCorriente methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:29'!saldo:unSaldosuper saldo:unSaldo! !!CuentaCorriente methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:28'!numeroCuenta:unNumerosuper numeroCuenta:unNumero! !!CuentaCorriente methodsFor: 'modifying' stamp: 'Anonymous 9/11/2025 16:29'!dniTitular:unDnisuper dniTitular:unDni! !!CuentaCorriente methodsFor: 'asString' stamp: 'Anonymous 9/11/2025 18:07'!asString^ super asString, ' Limite de descubierto: ', limiteDescubierto asString ! !